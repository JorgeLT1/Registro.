@page "/pagosDetalle"
@page "/pagosDetalle/{id:int}"
@inject PagosDetalleBLL pagosDetalle
@inject PagosBLL pagosBLL
@inject PersonaBLL personaBLL
@inject OcupacionesBLL ocupacion

<EditForm Model="pagosDetalle">
<div class="accordion-item">
    <div class="modal-header">
        <h1>Registro de Pagos Detalle</h1>
    </div>
 <div class="accordion-body">     
      <label for="id">ID</label>
    <InputNumber @bind-Value="pagosdetalle.id" class="form-control" />
    <button type="button" class="btn btn-primary"  @onclick="Buscar" > Buscar </button>
      <br />
      <br />

      <label for="pagosdetalle.PagoId">Pagos ID</label>
      <select @bind="pagosdetalle.PagoId" class="form-control">
        @foreach (var item in pagosBLL.GetListst())
        {
            <option value="@item.PagosId">@item.PagosId</option>
        }
      </select>

        <label for="pagosdetalle.personaid">Pagos ID</label>
        <select @bind="pagosdetalle.prestamosid" class="form-control">
        @foreach (var item in pagosBLL.PrestamosList())
        {
            <option value="@item.PrestamosId">@item.PrestamosId</option>
        }
      </select>

    <label for="valorPagado">Valor Pagado</label>
    <InputNumber @bind-Value="pagosdetalle.valorPagado" class="form-control" />
      <br />
      <br />

   </div>

    <div class="accordion-flush">
        <button type="button" class="btn btn-primary"  @onclick="Nuevo" > Nuevo </button>
        <button type="button" class="btn btn-success" @onclick="Guardar" > Guardar</button>
        <button type="button" class="btn btn-danger" @onclick="Eliminar"> Eliminar</button>
    </div>
</div>
</EditForm>

@code {
    [Parameter]
    public int ID {get; set; }
    public PagosDetalle pagosdetalle {get; set; } = new PagosDetalle();

    protected override void OnInitialized()
    {
        if(ID > 0)
        {
            this.pagosdetalle.id= ID;
            this.Buscar();
        }
    } 
    public void Buscar()
    {
        if (pagosdetalle.id > 0)
        {
            var encontrado = pagosDetalle.Buscar(pagosdetalle.id);
            Nuevo();
            if (encontrado != null)
                this.pagosdetalle = encontrado;
        }
    }


    public void Nuevo()
    {
        this.pagosdetalle = new PagosDetalle();
    }

    public void Guardar()
    {
        var guardado = pagosDetalle.Guardar(pagosdetalle);
        
        if (guardado)
        {
            Nuevo();
        }
        else
        {
        }

    }

    public void Eliminar()
    {
        if(pagosDetalle.Eliminar(pagosdetalle))
        {
            Nuevo();
        }
    }

}
